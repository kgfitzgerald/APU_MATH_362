---
title: "Problem Set 03"
subtitle: "Week 02 Day 02"
output: 
  html_document:
    toc: true
    toc_float: true
    number_section: false
    highlight: tango
    theme: "cosmo"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

# Learning objectives

+ Construct confidence intervals for two means - by hand and in R
+ Use properties of random variables and their distributions to develop and evaluate estimators
+ Distinguish between two-sample and paired-mean analyses
+ Identify parameters of interest and appropriate analyses based on research scenarios

# Exercises

## By hand or typed

1. Independent random samples of heights of adult males living in two countries yielded the following results: $n_X = 12$, $\overline{X} = 65.7$ inches, $s_X = 4$ inches and $n_Y = 15$, $\overline{Y} = 68.2$ inches, $s_Y = 3$ inches. Find an approximate 98% confidence interval for the difference $\mu_X - \mu_Y$ of the means of the populations of heights. Assume that $\sigma_X^2 = \sigma_Y^2$.

1. Let $X_1, X_2, \dots X_n \sim N(\mu_X, \sigma^2)$ and $Y_1, Y_2, \dots Y_n \sim N(\mu_Y, \sigma^2)$ be independent random samples. Show that $S_p^2 = \frac{(n-1)S_x^2 + (m-1)S_y^2}{n + m - 2}$ is an unbiased estimator of $\sigma^2$. 

1. Suppose a randomized control trial (RCT) was conducted to evaluate the effectiveness of a curriculum in improving students' reading comprehension. Reading comprehension scores for students who received the treatment (new curriculum) are denoted by $Y^T_1, Y^T_{2}, \dots Y^T_{n_T}$ and scores for students who received the control ("business as usual" curriculum) are denoted by $Y^C_1, Y^C_{2}, \dots Y^C_{n_C}$ where $n_T$ is the sample size in the treatment group and $n_C$ is the sample size in the control group. You can assume the two samples are independent and normally distributed with means $\mu_T$ and $\mu_C$ respectively, and a common variance $\sigma^2$. Develop an estimator for $\mu_T - \mu_C$ and a formula for constructing a confidence interval. 

1. Let $\overline{X}$, $\overline{Y}$, $S_X^2$ and $S_Y^2$ be the respective sample means and unbiased estimates of the variances obtained from independent samples of sizes $n_X$ and $n_Y$ from the normal distributions $N(\mu_X, \sigma_X^2)$ and $N(\mu_Y, \sigma_Y^2)$, where $\mu_X, \mu_Y, \sigma_X^2, \sigma_Y^2$ are unknown. If $d = \frac{\sigma^2_X}{\sigma_Y^2}$ is a known constant:

    (a) Argue that $\frac{(\overline{X} - \overline{Y}) - (\mu_X - \mu_Y)}{\sqrt{\frac{d\sigma_Y^2}{n_X} + \frac{\sigma_Y^2}{n_Y}}}$ is $N(0,1)$

    (b) Argue that $\frac{(n_X-1)S_X^2}{d\sigma_Y^2} + \frac{(n_Y-1)S_Y^2}{\sigma_Y^2}$ is $\chi^2_{n_X + n_Y - 2}$

    (c) Argue that the two random variables in (a) and (b) are independent

    (d) With these results, construct a random variable (not depending on $\sigma_Y^2$) that has a $t$ distribution and that can be used to construct a confidence interval for $\mu_X - \mu_Y$

## Typed

5. State a research question where you would use each of the following procedures to estimate a confidence interval for two means. 

      (a) Two-sample Pooled-t interval
      (b) Welch's t-interval
      (c) Paired t-interval

6. In each of the following scenarios, determine if the data are paired

    (A) Compare pre- (beginning of semester) and post-test (end of semester) scores of students.

    (B) Assess gender-related salary gap by comparing salaries of randomly sampled men and women.

    (C) Compare artery thicknesses at the beginning of a study and after 2 years of taking Vitamin E for the same group of patients.

    (D) We would like to know if Intel’s stock and Southwest Airlines’ stock have similar rates of return. To find out, we take a random sample of 50 days, and record Intel’s and Southwest’s stock on those same days.

    (E) A school board would like to determine whether there is a difference in average SAT scores for students at one high school versus another high school in the district. To check, they take a simple random sample of 100 students from each high school.


For each of the following scenarios in Questions 7 - 13,

  (a) State a research question relevant to the data that can be investigated via a confidence interval
  (b) State the parameter of interest using appropriate notation
  (c) Obtain a relevant point estimate - use appropriate notation to state your result (e.g. $\overline{X} = 4)$
  (d) Obtain a confidence interval for your parameter of interest. Interpret your confidence in context. 
  (e) State what assumptions your confidence interval relies on
  (f) What conclusion do you draw about your research question in (a)? 

You should use `t.test()` or `prop.test()` to compute your point estimates and confidence intervals. You can read the documentation for these functions by running `?t.test` and `?prop.test` in your console. Make sure to pay attention to default arguments and change them as necessary to fit your desired analysis.

7. [HTZ 7.1-5] As a clue to the amount of organic waste in Lake Macatawa, a count was made of the number of bacteria colonies in 100 milliliters of water. The number of colonies, in hundreds, for $n=30$ samples of water from the east basin yielded the following data. Use confidence level of 90%. 

```{r}
x <- c(93, 140, 8, 120, 3, 120, 33, 70, 91, 61, 7, 100, 19,
       98, 119, 23, 14, 94, 57, 9, 66, 53, 28, 76, 58, 9, 
       73, 49, 37, 92)
```

```{r, echo = FALSE, eval = FALSE}
t.test(x)
```

8. [HTZ 7.2-4] Let $X$ and $Y$ equal, respectively, the blood volumes in milliliters for a male who is a paraplegic and participates in vigorous physical activities and for a male who is able-bodied and participates in everyday, ordinary activities. Assume that $X \sim N(\mu_X, \sigma^2_X)$ and $Y \sim N(\mu_Y, \sigma_Y^2)$. The following are the $n_X = 7$ and $n_Y = 10$ observations of $X$ and $Y$. Use confidence level of 95%.

```{r}
x <- c(1612, 1352, 1456, 1222, 1560, 1456, 1924)
y <- c(1082, 1300, 1092, 1040, 910, 1248, 1092, 1040, 1092, 1288)
```

```{r, eval = FALSE, echo = FALSE}
t.test(x, y)
```

9. [HTZ 7.2-7] An automotive supplier is considering changing its electrical wire harness to save money. The idea is to replace a current 20-gauge wire with a 22-gauge wire. Because not all wires in the harness can be changed, the new wire must work with the current wire splice process. To determine whether the new wire is compatible, random samples were selected and measured with a pull test. A pull test measures the force required to pull the spliced wires apart. The minimum pull force required by the customer is 20 pounds. Twenty observations of the forces needed for the current wire and new wire are given below. Use confidence level of 90%. *(BONUS: Construct a side-by-side boxplot of the two sets of data)*

```{r}
current <- c(28.8, 24.4, 30.1, 25.6, 26.4, 23.9, 22.1, 
             22.5, 27.6, 28.1, 20.8, 27.7, 24.4, 25.1,
             24.6, 26.3, 28.2, 22.2, 26.3, 24.4)

new <- c(14.1, 12.2, 14, 14.6, 8.5, 12.6, 13.7, 14.8,
         14.1, 13.2, 12.1, 11.4, 10.1, 14.2, 13.6,
         13.1, 11.9, 14.8, 11.1, 13.5)
```


```{r, eval = FALSE, echo = FALSE}
t.test(current, new, conf.level = 0.90)

current <- data.frame(x = current) %>% 
  mutate(type = "current")

new <- data.frame(x = new) %>% 
  mutate(type = "new")
data <- rbind(current, new)
ggplot(data, aes(y = x, x = type)) +
  geom_boxplot()
```

10. [HTZ 7.2-9] Students in a semester-long health-fitness program have their percentage of body fat measured at the beginning of the semester and at the end of the semester. The following measurements give these percentages for ten males in the class. Use confidence level of 90%.

```{r}
pre <- c(11.1, 19.5, 14, 8.3, 12.4, 
         7.89, 12.1, 8.3, 12.31, 10)

post <- c(9.97, 15.8, 13.02, 9.28, 11.51, 
          7.4, 10.7, 10.4, 11.4, 11.95)
```


```{r, eval = FALSE, echo = FALSE}
t.test(pre, post, paired = TRUE, conf.level = 0.9)
```

11. [HTZ 7.2-10] Twenty-four 9th and 10th grade high school girls were put on an ultraheavy rope-jumping program. The following data give the time difference in seconds for each girl ("before program time" minus "after program time") for the 40 yard dash. Use confidence level of 95%.

```{r}
time_diff <- c(0.28, 0.01, 0.13, 0.33, -0.03, 0.07, -0.18, -0.14,
               -0.33, 0.01, 0.22, 0.29, -0.08, 0.23, 0.08, 0.04,
               -0.30, -0.08, 0.09, 0.70, 0.33, -0.34, 0.50, 0.06)
```

```{r, eval = FALSE, echo = FALSE}
t.test(time_diff, alternative = "greater")
```


12. [HTZ 7.3-11]For developing countries in Asia (excluding China) and Africa, random samples of $n_1 = 1300$ and $n_2 = 1100$ yielded $y_1 = 520$ and $y_2 = 385$ children with chronic malnutrition, respectively. Use confidence level of 95%.

```{r, eval = FALSE, echo = FALSE}
x <- c(520, 385)
n <- c(1300, 1100)
prop.test(x, n, correct = FALSE)
```

13. Public health officials in a large city decided that if compelling evidence could be presented that less than 90% o children under six years of age in the city had received the DPT vaccine, then they would carry out an expensive immunization program throughout the city. A random sample was taken of 537 children under six years of age in the city; of these 460 had been immunized for DPT. Use a one-sided 99% confidence interval.
