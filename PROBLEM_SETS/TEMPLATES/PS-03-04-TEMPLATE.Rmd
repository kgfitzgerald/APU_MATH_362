---
title: "Problem Set 03-04"
subtite: "TEMPLATE"
output: 
  html_document:
    toc: true
    toc_float: true
    number_section: false
    highlight: tango
    theme: "cosmo"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
```

```{r}
library(tidyverse)
library(broom)
```


## Summary / Reflection Prompts

*RP1: What were the main concepts covered in this assignment?*

*RP2: What's one thing you understand better after completing these problems?*

*RP3: What problems gave you the most trouble? What was difficult about them/where did you get stuck?*

## Exercise 1

A. Paired
B. Not paired
C. Paired
D. Paired
E. Not paired

## Exercise 2

```{r}
x <- c(93, 140, 8, 120, 3, 120, 33, 70, 91, 61, 7, 100, 19,
       98, 119, 23, 14, 94, 57, 9, 66, 53, 28, 76, 58, 9, 
       73, 49, 37, 92)

t.test(x, conf.level = 0.9)
```

```{r, echo = FALSE}
results <- tidy(t.test(x, conf.level = 0.9))
mean <- round(results$estimate, 2)
CIlb <- round(results$conf.low, 2)
CIub <- round(results$conf.high, 2)
```

a. The parameter of interest is $\mu$, the mean amount of organic waste in 100 mililiters of water in Lake Macatawa. 
b. The point estimate is $\bar{X} = `r mean`$
c. We are 90% confident that the average amount of organic waste in 100 mililiters of water in Lake Macatawa is between `r CIlb` and `r CIub`

## Exercise 3

```{r ex-3}
x <- c(1612, 1352, 1456, 1222, 1560, 1456, 1924)
y <- c(1082, 1300, 1092, 1040, 910, 1248, 1092, 1040, 1092, 1288)
t.test(x, y)
```

```{r, echo = FALSE}
results <- tidy(t.test(x, y))
xbar <- round(results$estimate1, 2)
ybar <- round(results$estimate2, 2)
estimate <- round(results$estimate, 2)
CIlb <- round(results$conf.low, 2)
CIub <- round(results$conf.high, 2)
```

a. The parameter of interest is $\mu_X - \mu_Y$, the  difference in average blood volumes between the two groups of males
b. The point estimate is $\bar{X} - \bar{Y} = `r xbar` - `r ybar` = `r estimate`$
c. We are 95% confident that the difference in means is between `r CIlb` and `r CIub`

## Exercise 4

```{r ex-4}
pre <- c(11.1, 19.5, 14, 8.3, 12.4, 
         7.89, 12.1, 8.3, 12.31, 10)

post <- c(9.97, 15.8, 13.02, 9.28, 11.51, 
          7.4, 10.7, 10.4, 11.4, 11.95)

t.test(pre, post, paired = TRUE, conf.level = .9)
```

```{r, echo = FALSE}
results <- tidy(t.test(pre, post, paired = TRUE, conf.level = .9))
mean <- round(results$estimate, 2)
CIlb <- round(results$conf.low, 2)
CIub <- round(results$conf.high, 2)
```

a. The parameter of interest is $\mu_D$ the average difference in test scores
b. The point estimate is $\bar{X_D} = `r mean`$
c. We are 90% confident that the average difference in test scores is between `r CIlb` and `r CIub`

## Exercise 5

```{r ex-5}
time_diff <- c(0.28, 0.01, 0.13, 0.33, -0.03, 0.07, -0.18, -0.14,
               -0.33, 0.01, 0.22, 0.29, -0.08, 0.23, 0.08, 0.04,
               -0.30, -0.08, 0.09, 0.70, 0.33, -0.34, 0.50, 0.06)
t.test(time_diff)
```

```{r, echo = FALSE}
results <- tidy(t.test(time_diff))
mean <- round(results$estimate, 2)
CIlb <- round(results$conf.low, 2)
CIub <- round(results$conf.high, 2)
```

a. The parameter of interest is $\mu_D$, the average improvement in times. 
b. The point estimate is $\bar{X_D} = `r mean`$
c. We are 95% confident that the average improvement in times is between `r CIlb` and `r CIub`

## Exercise 6

The population distribution of `rating` is unimodal and slightly skewed left.

```{r ex-6, message = FALSE, warning = FALSE}
library(tidyverse)
library(infer)
library(ggplot2movies)

ggplot(movies, aes(x = rating)) +
  geom_histogram(color = "white")
```

## Exercise 7

The sample distribution looks relatively normal - it is unimodal. We expect it to be (roughly) similar to the population distribution in terms of center and spread.

```{r ex-7}
n <- 50

set.seed(437)
sample <- movies %>% 
  sample_n(n)

ggplot(data = sample, aes(x = rating)) +
  geom_histogram(binwidth = 0.5, color = "white")

sample %>% 
  summarise(avg_rating = mean(rating))
```

## Exercise 8

```{r}
sims <- rep_sample_n(movies, size = 50, 
                            reps = 10000, replace = TRUE)
```

`sims` has 500,000 rows: 50 randomly selected movies for each of the 10,000 random samples. It contains all the same columns as `movies`, plus an additional column called `replicate` that specifies which of the 10,000 samples the row corresponds to. 

## Exercise 9

```{r}
sample_means <- sims %>% 
  group_by(replicate) %>% 
  summarise(xbar = mean(rating))
```

`sample_means` has 10,000 rows, one for each random sample, and two columns: `replicate` and `xbar`. `replicate` is the ID variable to specify which of the 10,000 random samples the row corresponds to. `xbar` contains the sample means computed from each of the 10,000 samples. 


## Exercise 10

```{r}
ggplot(data = sample_means, aes(x = xbar)) +
  geom_histogram(color = "white")
```

The sampling distribution of the sample means is approximately normal. It has the same center as the population distribution, but a smaller spread (because the variance is $\sigma^2/n$ instead of $\sigma$). 

## Exercise 11




## Exercise 12



## Exercise 13



## Exercise 14



## Exercise 15



## Exercise 16



## Exercise 17


## Exercise 18


## Exercise 19


## Exercise 20


## Exercise 21


## Exercise 22


## Exercise 23


## Exercise 24



